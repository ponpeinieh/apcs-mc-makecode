### @explicitHints 1

# Unit 5: Lesson 3 - Coding the Lighting System  

## Step 1
We extend the animation from Lesson 2 by adding the lighting effect generated by wind power. When the turbine blades rotate for a while, they generate electricity that lights up the lamps.

First, we need to manually dig a trench and lay a redstone circuit to connect the redstone lamps.

Directly behind the base of the wind turbine, you need to dig a trench **two blocks deep and five blocks long**, and at the last block of the trench, fill in a grass block to create a step up to the surface.

Place **Redstone Dust** on blocks 2, 3, 4, 5, and 6 (5 and 6 are actually two faces of the same block connected). Do not place **Redstone Dust** on block 1 (the block closest to the wind turbine base). This is reserved for placing a **Block of Redstone** to act as the source of the redstone signal. Place a **Redstone Lamp** on the ground at the end of the trench.

<img src="https://raw.githubusercontent.com/ponpeinieh/apcs-mc-makecode/master/computing/unit-5/redstone.png" alt="Redstone Circuit Image" width="200"/>

## Step 2
Before the loop at the end of Lesson 2, add a ``||Blocks:place [block] at||`` code block.

```template
player.onChat("wind_turbine", function () {
    for (let index = 0; index < 10; index++) {
        blocks.clone(
        world(39, 70, -433),
        world(45, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(31, 70, -433),
        world(37, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(23, 70, -433),
        world(29, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
    }
})
```

#### ~ tutorialhint
``` blocks
player.onChat("wind_turbine", function () {
    blocks.place(GRASS, pos(0, 0, 0))
    for (let index = 0; index < 10; index++) {
        blocks.clone(
        world(39, 70, -433),
        world(45, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(31, 70, -433),
        world(37, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(23, 70, -433),
        world(29, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
    }
})
```

## Step 3
Use the dropdown menu to change ``||Blocks:Grass||`` to ``||Blocks:Block of Redstone||``.

Next, open the ``||positions:POSITIONS||`` drawer and drag the ``||positions:world [0] [0] [0]||`` code block into your workspace.

Replace the ``||blocks:relative||`` position code block in the ``||Blocks:place [block] at||`` code block with the ``||positions:world [0] [0] [0]||`` code block.

#### ~ tutorialhint
``` blocks
player.onChat("wind_turbine", function () {
    blocks.place(REDSTONE_BLOCK, world(0, 0, 0))
    for (let index = 0; index < 10; index++) {
        blocks.clone(
        world(39, 70, -433),
        world(45, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(31, 70, -433),
        world(37, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(23, 70, -433),
        world(29, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
    }
})
```

## Step 4 
Go to the **block 1** position marked in Step 1 (the block closest to the wind turbine base), stand on top of it and get the coordinates of your current position. Fill these coordinates into the ``||Blocks:place [block] at||`` code block's ``||positions:world [0] [0] [0]||`` code block. In our example, the coordinates are **(7, 81, -412)**.

By placing a **Block of Redstone** at this position, it will provide the **power source** for our redstone signal circuit and connect the redstone signal circuit, lighting the **Redstone Lamp** at the end.

#### ~ tutorialhint
``` blocks
player.onChat("wind_turbine", function () {
    blocks.place(REDSTONE_BLOCK, world(7, 81, -412))
    for (let index = 0; index < 10; index++) {
        blocks.clone(
        world(39, 70, -433),
        world(45, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(31, 70, -433),
        world(37, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(23, 70, -433),
        world(29, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
    }
})
```

## Step 5
Add another ``||Blocks:place [block] at||`` code block after the loop. Note that it should be placed outside the loop.

You can duplicate the code block from the ``||Blocks:place [Block of Redstone] at||`` code block.

#### ~ tutorialhint
``` blocks
player.onChat("wind_turbine", function () {
    blocks.place(REDSTONE_BLOCK, world(7, 81, -412))
    for (let index = 0; index < 10; index++) {
        blocks.clone(
        world(39, 70, -433),
        world(45, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(31, 70, -433),
        world(37, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(23, 70, -433),
        world(29, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
    }
    blocks.place(REDSTONE_BLOCK, world(7, 81, -412))
})
```

## Step 6
Use the dropdown menu to change ``||Blocks:Block of Redstone||`` to ``||Blocks:Air||``.

This will cut off the power source for the redstone signal circuit, causing the redstone lamp to turn off.

#### ~ tutorialhint
``` blocks
player.onChat("wind_turbine", function () {
    blocks.place(REDSTONE_BLOCK, world(7, 81, -412))
    for (let index = 0; index < 10; index++) {
        blocks.clone(
        world(39, 70, -433),
        world(45, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(31, 70, -433),
        world(37, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(23, 70, -433),
        world(29, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
    }
    blocks.place(AIR, world(7, 81, -412))
})
```

## Step 7

Test your code. If successful, every time you run your **wind_turbine** command, the turbine blades will rotate, light the **redstone lamp**, then stop, and the redstone lamp will turn off.

## Step 8

Get the ``||Loops:forever||`` code block. This block creates a loop that runs forever without stopping, so we can make our animation repeat continuously.

## Step 9

Drag the ``||Loops:forever||`` code block into your coding workspace, and then drag all the code from the ``||player:on chat command "wind_turbine"||`` code block into the ``||Loops:forever||`` code block.

#### ~ tutorialhint
``` blocks
player.onChat("wind_turbine", function () {
})

loops.forever(function () {
    blocks.place(REDSTONE_BLOCK, world(7, 81, -412))
    for (let index = 0; index < 10; index++) {
        blocks.clone(
        world(39, 70, -433),
        world(45, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(31, 70, -433),
        world(37, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(23, 70, -433),
        world(29, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
    }
    blocks.place(AIR, world(7, 81, -412))
})
```   

## Step 10

Change the number of times in ``||Loops:repeat [10] times||`` to **20**.

#### ~ tutorialhint
``` blocks
player.onChat("wind_turbine", function () {
})

loops.forever(function () {
    blocks.place(REDSTONE_BLOCK, world(7, 81, -412))
    for (let index = 0; index < 20; index++) {
        blocks.clone(
        world(39, 70, -433),
        world(45, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(31, 70, -433),
        world(37, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(23, 70, -433),
        world(29, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
    }
    blocks.place(AIR, world(7, 81, -412))
})
```      

## Step 11

How can we simulate changes in wind power?

How can we simulate a situation where the turbine is stationary when there is no wind? So far, our turbine blades keep rotating endlessly, and the redstone lamp quickly lights up and then turns off. We can add appropriate **pauses** in this code to create the effect of **wind stopping**.

## Step 12

Go back to the ``||Loops:LOOPS||`` drawer and select the ``||Loops:pause (ms)||`` code block. Drag and drop it into your code, placing it after the last ``||Blocks:place [air] at||`` code block. Set the time to **5000** milliseconds.

5000 milliseconds (ms) is 5 seconds, which will make our animation pause for 5 seconds, simulating the effect of wind power stopping for 5 seconds.

#### ~ tutorialhint
``` blocks
player.onChat("wind_turbine", function () {
   
})

loops.forever(function () {
    blocks.place(REDSTONE_BLOCK, world(7, 81, -412))
    for (let index = 0; index < 20; index++) {
        blocks.clone(
        world(39, 70, -433),
        world(45, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(31, 70, -433),
        world(37, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
        blocks.clone(
        world(23, 70, -433),
        world(29, 76, -433),
        world(4, 95, -408),
        CloneMask.Replace,
        CloneMode.Normal
        )
    }
    blocks.place(AIR, world(7, 81, -412))
    loops.pause(5000)
})
```

## Step 13

Run and test your code. Your wind blades should now rotate 20 times, then stop for 5 seconds, and repeat indefinitely. Your **redstone lamp** should light up only when the turbine blades are rotating.